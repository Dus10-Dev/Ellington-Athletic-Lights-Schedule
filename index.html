<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ellington Athletic Field Lights Schedule</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f8ff; /* Light blue background */
        }
        h1 {
            color: #003366; /* Dark blue */
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ccc;
        }
        th {
            background-color: #003366; /* Dark blue for header */
            color: white;
        }
        tr:nth-child(even) {
            background-color: #e6f0ff; /* Light blue for even rows */
        }
        tr:hover {
            background-color: #d0e0ff; /* Lighter blue on hover */
        }
        label {
            margin-right: 10px;
        }
        button {
            background-color: #ffcc00; /* Yellow button */
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background-color: #ffbb00; /* Darker yellow on hover */
        }
    </style>
</head>
<body>

<h1>Ellington Athletic Field Lights Schedule</h1>
<p>Last updated: <span id="lastUpdated"></span></p>

<label for="facilityFilter">Filter by Facility:</label>
<select id="facilityFilter">
    <option value="All">All</option>
    <option value="Ellington Pinney Fields">Ellington Pinney Fields</option>
    <option value="Robert Tedford Memorial Park">Robert Tedford Memorial Park</option>
</select>

<label for="fieldFilter">Filter by Field:</label>
<select id="fieldFilter">
    <option value="All">All</option>
    <option value="Pinney Field D">Pinney Field D</option>
    <option value="Small Soccer Fields">Small Soccer Fields</option>
    <option value="LLM2">LLM2</option>
    <option value="Football Field">Football Field</option>
    <option value="Lisa's Field">Lisa's Field</option>
</select>

<label for="startDate">Start Date:</label>
<input type="date" id="startDate" />

<label for="endDate">End Date:</label>
<input type="date" id="endDate" />

<button onclick="filterSchedule()">Filter Schedule</button>

<table>
    <thead>
        <tr>
            <th>Facility</th>
            <th>Field</th>
            <th>Start Date</th>
            <th>Start Time</th>
            <th>End Time</th>
        </tr>
    </thead>
    <tbody id="scheduleTableBody">
        <!-- Schedule data will be populated here -->
    </tbody>
</table>

<script>
    let scheduleData = [];

    // Fetch CSV data and parse it
    fetch('schedule.csv')
        .then(response => response.text())
        .then(data => {
            const rows = data.split('\n').slice(1); // Remove header
            scheduleData = rows.map(row => {
                const columns = row.split(',');
                return {
                    Facility: columns[0],
                    Field: columns[1],
                    'Start Date': columns[2].trim(),
                    'Start Time': columns[3].trim(),
                    'End Time': columns[4].trim()
                };
            });
            displaySchedule(); // Initially display all schedules
        })
        .catch(error => console.error('Error fetching the CSV file:', error));

    // Display last updated date
    document.getElementById('lastUpdated').innerText = new Date().toLocaleDateString();

    function displaySchedule() {
        const tbody = document.getElementById('scheduleTableBody');
        tbody.innerHTML = ''; // Clear existing rows

        // Populate table with data
        scheduleData.forEach(row => {
            const newRow = tbody.insertRow();
            newRow.innerHTML = `
                <td>${row.Facility}</td>
                <td>${row.Field}</td>
                <td>${row['Start Date']}</td>
                <td>${row['Start Time']}</td>
                <td>${row['End Time']}</td>
            `;
        });
    }

    function filterSchedule() {
        const facilityFilter = document.getElementById('facilityFilter').value;
        const fieldFilter = document.getElementById('fieldFilter').value;
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;

        const tbody = document.getElementById('scheduleTableBody');
        tbody.innerHTML = ''; // Clear current table rows

        scheduleData.forEach(row => {
            const rowDate = row['Start Date'];

            // Check facility and field filter conditions
            const facilityMatch = facilityFilter === 'All' || row.Facility === facilityFilter;
            const fieldMatch = fieldFilter === 'All' || row.Field === fieldFilter;

            // Check date range
            const isSameDateSelected = startDate === endDate && rowDate === startDate;
            const isWithinDateRange = (rowDate >= startDate && rowDate <= endDate) || isSameDateSelected;

            // If all conditions match, add the row to the table
            if (facilityMatch && fieldMatch && isWithinDateRange) {
                const newRow = tbody.insertRow();
                newRow.innerHTML = `
                    <td>${row.Facility}</td>
                    <td>${row.Field}</td>
                    <td>${row['Start Date']}</td>
                    <td>${row['Start Time']}</td>
                    <td>${row['End Time']}</td>
                `;
            }
        });
    }
</script>
</body>
</html>
